# 问卷星自动填写系统 - 增强版使用说明

## 🎯 系统概述

问卷星自动填写系统是一个功能强大的自动化问卷填写工具，专门针对问卷星平台的各种题型进行了优化。本增强版特别强化了矩阵量表题的处理能力，并集成了AI智能答题功能。

## ✨ 主要特性

### 🔧 核心功能
- **智能识别**: 自动识别问卷星的各种题型
- **结构解析**: 完整解析矩阵题的行列结构
- **选项提取**: 自动提取所有选项文本
- **错误处理**: 提供详细的错误提示和解决建议

### 📊 矩阵量表题支持
- **多行问题**: 支持一个题目包含多个子问题
- **多列选项**: 支持多种评分选项（李克特量表、数字量表等）
- **智能填写**: 提供多种填写策略（随机、平均、偏置、模式）
- **配置灵活**: 支持每行独立的填写策略配置

### 🤖 AI智能功能
- **智能答题**: 基于AI模型生成自然、真实的答案
- **文本生成**: 自动生成符合语境的文本回答
- **多模型支持**: 支持GPT、Claude等多种AI模型
- **提示模板**: 可自定义AI答题的提示模板

### ⚙️ 配置管理
- **可视化配置**: 直观的图形化配置界面
- **参数管理**: 完善的参数设置和验证
- **配置导入导出**: 支持配置的保存和分享
- **实时验证**: 配置参数的实时验证和提示

## 🚀 快速开始

### 1. 系统启动
```bash
# 方法1: 使用启动脚本（推荐）
python 启动系统.py

# 方法2: 直接运行主程序
python 问卷星终极版.py
```

### 2. 基本使用流程
1. **输入问卷链接**: 在URL输入框中粘贴问卷星链接
2. **解析问卷**: 点击"解析问卷"按钮分析问卷结构
3. **配置参数**: 根据解析结果配置填写参数
4. **开始填写**: 点击"开始填写"按钮启动自动化填写

## 📋 详细功能说明

### 矩阵量表题配置

#### 填写策略
- **随机策略 (random)**: 完全随机选择选项
- **平均策略 (average)**: 各选项选择概率相等
- **偏置策略 (bias)**: 根据偏置方向调整选择概率
- **模式策略 (pattern)**: 按照特定模式进行选择

#### 偏置方向
- **左侧偏置 (left)**: 倾向于选择左侧选项
- **中间偏置 (center)**: 倾向于选择中间选项
- **右侧偏置 (right)**: 倾向于选择右侧选项

#### 模式类型
- **正常模式 (normal)**: 正态分布选择
- **极端模式 (extreme)**: 倾向于选择两端选项
- **保守模式 (conservative)**: 倾向于选择中间选项

### AI功能配置

#### 启用AI功能
1. 在"AI配置"选项卡中勾选"启用AI功能"
2. 输入API密钥（支持OpenAI、Claude等）
3. 选择AI模型和参数
4. 配置提示模板

#### 提示模板示例
```
文本题: 请根据以下问题生成一个自然、真实的回答：{question}
矩阵题: 请为以下矩阵题选择一个合适的评分：{question}，选项：{options}
多选题: 请为以下多选题选择合适的选项：{question}，选项：{options}
```

### 高级配置

#### 延迟设置
- **最小延迟**: 每次操作的最小等待时间
- **最大延迟**: 每次操作的最大等待时间
- **页面延迟**: 页面跳转时的等待时间
- **题目延迟**: 每题填写之间的等待时间

#### 提交间隔
- **智能间隔**: 根据问卷复杂度自动调整提交间隔
- **批量暂停**: 每N份问卷后暂停指定时间
- **随机间隔**: 在指定范围内随机选择提交间隔

#### 代理设置
- **IP代理**: 支持使用代理IP轮换
- **代理API**: 支持多种代理服务商
- **切换模式**: 支持按提交次数或批量切换

## 🔧 配置参数详解

### 基础配置
```json
{
  "url": "问卷链接",
  "target_num": 100,
  "min_delay": 1,
  "max_delay": 3,
  "num_threads": 4
}
```

### 矩阵配置
```json
{
  "matrix_config": {
    "fill_strategy": "bias",
    "bias_direction": "center",
    "bias_strength": 0.3,
    "pattern_type": "normal",
    "row_strategies": {
      "0": {
        "strategy": "random",
        "bias": "center",
        "weight": 1.0
      }
    }
  }
}
```

### AI配置
```json
{
  "ai_config": {
    "enabled": true,
    "api_key": "your_api_key",
    "model": "gpt-3.5-turbo",
    "temperature": 0.7,
    "max_tokens": 150,
    "prompt_templates": {
      "text": "请根据以下问题生成一个自然、真实的回答：{question}",
      "matrix": "请为以下矩阵题选择一个合适的评分：{question}，选项：{options}"
    }
  }
}
```

## 🛠️ 故障排除

### 常见问题

#### 1. 模块导入错误
**问题**: `ModuleNotFoundError: No module named 'xxx'`
**解决**: 
- 确保所有依赖包已安装：`pip install selenium numpy requests`
- 检查Python路径设置
- 重新下载完整程序包

#### 2. ChromeDriver错误
**问题**: ChromeDriver版本不匹配或未找到
**解决**:
- 下载与Chrome浏览器版本匹配的ChromeDriver
- 将ChromeDriver放置在程序目录中
- 检查ChromeDriver权限设置

#### 3. 问卷解析失败
**问题**: 无法解析问卷结构
**解决**:
- 检查问卷链接是否正确
- 确认问卷是否已发布且可访问
- 尝试手动访问问卷确认状态

#### 4. 填写失败
**问题**: 自动填写过程中出现错误
**解决**:
- 检查网络连接稳定性
- 调整延迟参数避免操作过快
- 查看日志文件获取详细错误信息

### 日志查看
系统会在`logs`目录下生成详细的日志文件：
- `system.log`: 系统运行日志
- `test.log`: 测试运行日志
- `wjx_auto_*.log`: 问卷填写日志

## 📁 文件结构

```
wjx-master/
├── 问卷星终极版.py          # 主程序
├── 启动系统.py              # 启动脚本
├── 测试系统功能.py          # 功能测试脚本
├── ai_questionnaire_parser.py  # AI问卷解析模块
├── questionnaire_parser.py     # 问卷解析模块
├── questionnaire_filler.py     # 问卷填写模块
├── config_manager.py           # 配置管理模块
├── ui_enhancer.py              # UI增强模块
├── system_monitor.py           # 系统监控模块
├── ai_chat_tab.py              # AI聊天模块
├── chromedriver.exe            # Chrome浏览器驱动
├── config.json                 # 配置文件
├── logs/                       # 日志目录
├── sample_answers.json         # 示例答案
└── 使用说明.md                # 本说明文档
```

## 🔄 版本更新

### v2.0 增强版新功能
- ✅ 增强的矩阵量表题支持
- ✅ AI智能答题功能
- ✅ 可视化配置界面
- ✅ 完善的错误处理
- ✅ 系统性能监控
- ✅ 模块化架构设计

### 更新日志
- **2025-08-07**: 发布v2.0增强版
  - 新增矩阵量表题专门处理
  - 集成AI智能答题功能
  - 重构配置管理系统
  - 优化用户界面体验

## 📞 技术支持

### 联系方式
- **问题反馈**: 通过GitHub Issues提交
- **功能建议**: 欢迎提出改进建议
- **技术支持**: 查看日志文件获取详细错误信息

### 使用建议
1. **首次使用**: 建议先使用测试问卷熟悉功能
2. **参数调整**: 根据问卷复杂度调整延迟参数
3. **网络环境**: 确保网络连接稳定
4. **合规使用**: 请遵守问卷平台的使用条款

## ⚠️ 免责声明

本工具仅供学习和研究使用，请用户：
- 遵守相关法律法规
- 尊重问卷平台的使用条款
- 合理使用，避免对服务器造成过大压力
- 承担使用本工具的一切风险和责任

---

**祝您使用愉快！** 🎉
