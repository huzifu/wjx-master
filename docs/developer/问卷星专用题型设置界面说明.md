# 问卷星专用题型设置界面 - 功能说明

## 🎯 **设计理念**

这是专门针对问卷星平台设计的题型设置界面，考虑到问卷星的特殊需求和信效度要求，提供了完整的、专业的题型配置功能。

## ✨ **核心特性**

### 📊 **智能解析与显示**
- **自动题型识别**: 解析问卷后自动识别8种题型
- **动态界面刷新**: 解析完成后自动刷新界面显示所有题目
- **题型分类显示**: 按题型分组显示，清晰直观
- **实时状态更新**: 显示解析状态、题目总数、题型分布

### 🎛️ **多样化填写策略**
- **完全随机**: 所有选项等概率选择
- **偏向策略**: 左侧偏向、中间偏向、右侧偏向
- **分布模式**: 正态分布、极端倾向
- **自定义概率**: 精确控制每个选项的概率

### 📝 **题型专用设置**

#### 1. **单选题 (类型3)**
- ✅ 策略选择器
- ✅ 根据选项数量自动生成概率输入框
- ✅ 实时概率预览
- ✅ 批量策略设置

#### 2. **多选题 (类型4)**
- ✅ 选择数量控制 (如: 1-3个选项)
- ✅ 每个选项独立概率设置
- ✅ 批量策略应用

#### 3. **量表题 (类型5)**
- ✅ 专用量表策略 (偏向中间默认)
- ✅ 偏置强度控制 (0.1-0.9)
- ✅ 量表等级概率设置

#### 4. **矩阵题 (类型6)**
- ✅ 一致性设置 (0.0-1.0)
- ✅ 每行相同策略应用
- ✅ 特殊矩阵题处理

#### 5. **填空题 (类型1)**
- ✅ 文本生成策略选择
- ✅ 自定义填写内容
- ✅ 随机变化设置

#### 6. **多项填空 (类型2)**
- ✅ 每个填空项独立设置
- ✅ 提示信息显示
- ✅ 内容模板支持

#### 7. **下拉题 (类型7)**
- ✅ 下拉选择策略
- ✅ 选项概率设置
- ✅ 首选/末选策略

#### 8. **排序题 (类型11)**
- ✅ 排序策略选择
- ✅ 随机程度控制
- ✅ 选项列表预览

### 🔧 **专业工具功能**

#### **工具栏按钮**
- 🔄 **刷新界面**: 重新加载题目配置
- 📁 **导入配置**: 从JSON文件导入设置
- 💾 **导出配置**: 保存当前设置到文件
- 🔄 **重置默认**: 一键重置所有设置
- ⚡ **批量设置**: 批量应用策略到多个题目

#### **批量操作**
- **按题型批量设置**: 针对特定题型批量应用策略
- **策略快速切换**: 一键应用常用策略组合
- **概率快速分配**: 智能分配概率权重

### 📋 **界面布局**

```
🎯 问卷星题型设置 - 专业版                     [工具栏按钮]
├── 📊 解析状态
│   ├── 解析状态: ✅ 已解析
│   ├── 题目总数: 15
│   └── 题型分布: 单选题:5 | 多选题:3 | 量表题:7
├── 📝 单选题 (5题)                            [批量操作按钮]
│   ├── 第1题: 您的性别是？
│   │   ├── 填写策略: [随机▼]
│   │   └── 选项概率设置 (共2个选项)
│   │       ├── 1. 男 [1.0]
│   │       └── 2. 女 [1.0]
│   └── ...
├── 📝 多选题 (3题)
│   └── ...
└── 📝 量表题 (7题)
    └── ...
```

## 🎮 **使用流程**

### 第一步: 解析问卷
1. 在主界面输入问卷星链接
2. 点击"解析问卷"按钮
3. 系统自动识别题型和选项
4. 界面自动刷新显示所有题目

### 第二步: 配置策略
1. 查看题型分布和题目列表
2. 为每种题型选择合适的填写策略
3. 根据需要调整概率权重
4. 使用批量操作提高效率

### 第三步: 保存设置
1. 点击"💾 导出配置"保存当前设置
2. 设置自动应用到主程序配置
3. 可随时"📁 导入配置"恢复设置

### 第四步: 开始填写
1. 返回主界面的基础设置
2. 配置填写数量和间隔
3. 点击"开始填写"执行自动化

## 🧠 **智能特性**

### **概率自动计算**
- **策略切换时自动调整**: 选择策略后自动计算合适的概率
- **权重智能分配**: 根据选项位置智能分配权重
- **总和自动平衡**: 确保概率分配合理

### **界面自适应**
- **选项数量自适应**: 根据实际选项数量生成输入框
- **布局自动调整**: 自动调整网格布局适应不同选项数
- **滚动区域优化**: 大量题目时提供流畅滚动体验

### **配置持久化**
- **自动保存**: 设置变更时自动保存到主配置
- **格式兼容**: 与原有配置格式完全兼容
- **导入导出**: 支持配置文件的备份和分享

## 📊 **信效度保证**

### **随机性控制**
- **真随机算法**: 使用高质量随机数生成器
- **概率权重**: 支持精确的概率权重控制
- **分布模式**: 提供多种概率分布模式

### **一致性保证**
- **策略一致性**: 同类题目可应用相同策略
- **矩阵题一致性**: 矩阵题的每行保持填写一致性
- **时间间隔控制**: 配合主程序的时间控制功能

### **数据有效性**
- **逻辑验证**: 自动验证配置的逻辑合理性
- **范围检查**: 确保所有数值在有效范围内
- **错误提示**: 提供详细的错误提示和建议

## 🔧 **技术优势**

### **模块化设计**
- **独立组件**: 可独立使用和维护
- **接口标准**: 标准化的配置接口
- **扩展性强**: 易于添加新的题型支持

### **性能优化**
- **懒加载**: 按需加载界面组件
- **事件驱动**: 高效的事件处理机制
- **内存优化**: 优化的内存使用模式

### **错误处理**
- **异常捕获**: 完整的异常处理机制
- **用户友好**: 清晰的错误提示信息
- **自动恢复**: 错误后的自动恢复功能

## 💡 **使用建议**

### **针对不同研究场景**

#### **学术研究**
- 使用**正态分布**策略确保数据的自然分布
- 量表题选择**偏向中间**避免极端响应偏差
- 设置合适的**一致性参数**提高数据质量

#### **市场调研**
- 使用**随机策略**确保样本代表性
- 多选题控制**选择数量**模拟真实选择行为
- 定期**导出配置**保存不同项目的设置

#### **产品测试**
- 使用**自定义概率**突出重点选项
- 填空题设置**变化模式**增加数据丰富性
- 利用**批量设置**快速配置大量题目

### **最佳实践**
1. **先解析再配置**: 确保解析完成后再进行详细配置
2. **策略分层应用**: 先批量设置大策略，再细化个别题目
3. **定期备份配置**: 重要项目的配置及时导出备份
4. **测试验证**: 正式使用前先小规模测试验证效果

---

*这个界面是专门为问卷星平台设计的专业级题型设置工具，确保您的问卷填写既符合研究要求，又保证数据的信效度。*

