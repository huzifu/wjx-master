# 问卷星系统项目结构说明

## 项目概述

本项目是一个基于Python的问卷星自动化填写系统，采用模块化设计，具有良好的可维护性和扩展性。

## 目录结构

```
wjx-master/
├── core/                          # 核心功能模块
│   ├── parser/                    # 问卷解析模块
│   │   └── questionnaire_parser.py
│   ├── filler/                    # 问卷填写模块
│   │   └── questionnaire_filler.py
│   └── ai/                        # AI功能模块
│       ├── ai_chat_tab.py
│       └── ai_questionnaire_parser.py
│
├── modules/                       # 功能模块
│   ├── questionnaire/             # 问卷相关模块
│   └── automation/                # 自动化模块
│
├── config/                        # 配置管理
│   ├── settings/                  # 设置文件
│   │   └── config_manager.py
│   └── profiles/                  # 配置文件
│       └── sample_answers.json
│
├── ui/                           # 用户界面
│   ├── components/               # UI组件
│   │   ├── question_settings_ui.py  # 题型设置界面
│   │   └── ui_enhancer.py
│   └── themes/                   # 主题文件
│
├── system/                       # 系统模块
│   ├── monitor/                  # 系统监控
│   │   └── system_monitor.py
│   └── optimizer/                # 性能优化
│
├── tools/                        # 工具脚本
│   ├── test/                     # 测试工具
│   │   └── test_question_settings_ui.py
│   ├── diagnostic/               # 诊断工具
│   │   ├── ChromeDriver诊断.py
│   │   └── 诊断解析问题.py
│   └── maintenance/              # 维护工具
│       ├── cleanup_project.py
│       └── 简单优化脚本.py
│
├── docs/                         # 文档
│   ├── user/                     # 用户文档
│   │   ├── README.md
│   │   ├── 使用说明.md
│   │   └── 配置参数说明.md
│   └── developer/                # 开发者文档
│       └── 项目结构说明.md
│
├── resources/                    # 资源文件
│   ├── drivers/                  # 驱动程序
│   │   ├── chromedriver.exe
│   │   └── chromedriver-win64/
│   └── models/                   # AI模型
│       └── ai_models/
│
├── data/                         # 数据文件
│   ├── logs/                     # 日志文件
│   │   └── logs/
│   └── exports/                  # 导出文件
│       └── submission_log.csv
│
├── 问卷星终极版.py              # 主程序
├── cankao.py                     # 参考实现
└── 其他文件...
```

## 模块说明

### 1. 核心功能模块 (core/)

#### parser/ - 问卷解析模块
- **questionnaire_parser.py**: 增强版问卷解析器，支持各种题型的智能解析
- 功能：解析问卷结构、识别题型、提取选项信息

#### filler/ - 问卷填写模块  
- **questionnaire_filler.py**: 增强版问卷填写器，实现自动化填写
- 功能：根据配置自动填写各种题型

#### ai/ - AI功能模块
- **ai_chat_tab.py**: AI聊天界面，提供智能问答功能
- **ai_questionnaire_parser.py**: AI辅助问卷解析

### 2. 配置管理 (config/)

#### settings/ - 设置管理
- **config_manager.py**: 增强版配置管理器
- 功能：管理各种配置参数、题型设置、AI配置等

#### profiles/ - 配置文件
- **sample_answers.json**: 示例答案配置

### 3. 用户界面 (ui/)

#### components/ - UI组件
- **question_settings_ui.py**: 题型设置界面（基于cankao.py设计）
  - 支持8种题型的配置：单选题、多选题、矩阵题、填空题、多项填空、排序题、下拉框、量表题
  - 提供快捷操作：偏左、偏右、随机、平均分布
  - 工具提示功能
  - 滚动界面支持

- **ui_enhancer.py**: 界面增强组件

### 4. 系统模块 (system/)

#### monitor/ - 系统监控
- **system_monitor.py**: 系统性能监控和优化

### 5. 工具脚本 (tools/)

#### test/ - 测试工具
- **test_question_settings_ui.py**: 题型设置界面测试脚本

#### diagnostic/ - 诊断工具
- **ChromeDriver诊断.py**: ChromeDriver问题诊断
- **诊断解析问题.py**: 解析问题诊断

#### maintenance/ - 维护工具
- **cleanup_project.py**: 项目清理工具
- **简单优化脚本.py**: 简单优化脚本

## 题型设置界面特性

### 基于cankao.py的设计特点：

1. **完整的题型支持**
   - 单选题：支持权重配置和随机选择
   - 多选题：支持独立概率、最小/最大选择数
   - 矩阵题：支持行列权重配置
   - 填空题：支持文本模板配置
   - 多项填空：支持多个文本模板
   - 排序题：支持位置权重配置
   - 下拉框：支持选项概率配置
   - 量表题：支持评分权重配置

2. **用户友好的界面**
   - 标签页组织不同题型
   - 表格布局，清晰易读
   - 工具提示显示完整题目内容
   - 鼠标滚轮支持
   - 快捷操作按钮

3. **智能配置功能**
   - 偏左/偏右分布设置
   - 随机选择设置
   - 平均分布设置
   - 指定概率值设置

4. **数据管理**
   - 配置数据的读取和保存
   - 实时配置更新
   - 配置验证机制

## 使用方法

### 运行主程序
```bash
python 问卷星终极版.py
```

### 测试题型设置界面
```bash
python tools/test/test_question_settings_ui.py
```

### 项目清理
```bash
python tools/maintenance/cleanup_project.py
```

## 开发指南

### 添加新题型
1. 在 `ui/components/question_settings_ui.py` 中添加新的创建方法
2. 在 `create_ui()` 方法的 `question_types` 列表中添加新题型
3. 更新配置数据结构

### 扩展功能
1. 在对应模块目录下创建新文件
2. 更新相关导入语句
3. 添加必要的文档说明

## 注意事项

1. 确保ChromeDriver版本与Chrome浏览器版本匹配
2. 配置文件中包含敏感信息，注意保护
3. 使用前请仔细阅读使用说明文档
4. 定期备份重要配置文件

## 版本历史

- v1.0: 基础功能实现
- v2.0: 模块化重构，新增题型设置界面
- v2.1: 基于cankao.py的UI设计优化
